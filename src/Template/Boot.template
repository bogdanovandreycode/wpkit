<?php
namespace {{namespace}};

use WpToolKit\Controller\ViewLoader;
use WpToolKit\Loader\AttributeLoader;
use {{namespace}}\Main;

class Boot {
    public function __construct(
        private string $pluginFilePath,
    ) {
        $this->setUp_{{pluginName}}();

        add_action('init', [$this, 'hookInit_{{pluginName}}']);

        add_action('plugins_loaded', function () {
            load_plugin_textdomain(
                '{{pluginName}}-plugin',
                false,
                '/{{pluginName}}/languages/'
            );

            $this->hookPluginsLoaded_{{pluginName}}();
        });

        register_activation_hook( $pluginFilePath, [$this, 'activate_{{pluginName}}'] );
        register_deactivation_hook( $pluginFilePath, [$this, 'deactivate_{{pluginName}}'] );
    }

    public function setUp_{{pluginName}}(): void 
    {
        //TODO CODE
    }

    public function hookInit_{{pluginName}}(): void 
    {
        //TODO CODE
    }

    public function hookPluginsLoaded_{{pluginName}}(): void
    {
        $views = new ViewLoader();
        $views->loadFromYaml($this->pluginFilePath . '/config/views.yml', $this->pluginFilePath);

        $loader = new AttributeLoader(
            '{{namespace}}\Controller\Route',
            plugin_dir_path(__FILE__) . 'Controller/Route',
        );

        $loader->loadRoutes();

        new Main(
            $this->pluginFilePath,
            $views
        );
    }

    public function activate_{{pluginName}}(): void 
    {
        //TODO CODE
    }

    public function deactivate_{{pluginName}}(): void 
    {
        //TODO CODE
    }
}